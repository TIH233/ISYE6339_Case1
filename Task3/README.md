# Task 3: Production Estimation for 99% Autonomy

This folder contains the solution for **Task 3.1** of the BotWorld European Supply Chain case study.

## Objective

Estimate the production planning parameters to achieve 99% robustness:
1. **99%-robust steady daily production rate** for each category cluster
2. **Prior start days** to maintain 12-week (84-day) 99% autonomy

## Files

### Input Data
- `sim_batches/batch_*.csv.gz` - 100 simulation runs generated by Task 2 simulator
- `simulated_demand.csv.gz` - Aggregated daily demand statistics across simulations
- `segment_summary.csv.gz` - Demand aggregated by year and segment (Metro/Non-Metro)
- `annual_summary.csv.gz` - Demand aggregated by year

### Analysis Notebook
- **`Production_est.ipynb`** - Main Jupyter notebook containing complete Task 3 analysis

### Documentation
- `TASK3_SOLUTION_SUMMARY.md` - Detailed methodology and solution explanation
- `README.md` - This file

### Test Script
- `test_production_calculation.py` - Quick validation of calculation methodology

## Setup Instructions

### Prerequisites

Install required Python packages:

```bash
pip install pandas numpy matplotlib seaborn jupyter
```

Or if using conda:

```bash
conda install pandas numpy matplotlib seaborn jupyter
```

### Running the Analysis

#### Option 1: Jupyter Notebook (Recommended)

1. Start Jupyter:
   ```bash
   cd Task3
   jupyter notebook
   ```

2. Open `Production_est.ipynb` in your browser

3. Run all cells: `Cell` → `Run All`

4. Results will be saved to:
   - `cluster_production_rates.csv`
   - `prior_start_days.csv`
   - `daily_production_rates.png`
   - `prior_start_days.png`
   - `autonomy_inventory_2027.png`

#### Option 2: Convert to Python Script

```bash
jupyter nbconvert --to python Production_est.ipynb
python Production_est.py
```

#### Option 3: Test Script (Quick Validation)

```bash
python3 test_production_calculation.py
```

This runs a quick test with limited data to verify the methodology.

## Expected Outputs

### 1. cluster_production_rates.csv

Annual and daily production rates for each cluster:

| year | cluster | annual_demand_mean | annual_demand_p99 | daily_production_99robust | robustness_buffer_pct |
|------|---------|-------------------|-------------------|--------------------------|---------------------|
| 2027 | Cluster_1 | ... | ... | ... | ... |
| 2027 | Cluster_2 | ... | ... | ... | ... |
| ... | ... | ... | ... | ... | ... |

**Key columns:**
- `daily_production_99robust`: The steady daily production rate to achieve 99% robustness (units/day)
- `robustness_buffer_pct`: Additional capacity % over mean demand required for 99% robustness

### 2. prior_start_days.csv

Days to start production before each year begins:

| year | cluster | required_inventory_jan1 | daily_production_rate | prior_start_days |
|------|---------|------------------------|---------------------|-----------------|
| 2027 | Cluster_1 | ... | ... | ... |
| 2027 | Cluster_2 | ... | ... | ... |
| ... | ... | ... | ... | ... |

**Key column:**
- `prior_start_days`: Number of days before January 1st to start production

**Interpretation:** If `prior_start_days = 90` for Cluster 1 in 2027:
- Start producing Cluster 1 products on **October 3, 2026** (90 days before Jan 1, 2027)
- This builds sufficient inventory to ensure 12-week autonomy at 99% confidence

### 3. Visualizations

- **daily_production_rates.png**: Line plots showing production rates over years for each cluster
- **prior_start_days.png**: Bar chart comparing prior start days across years and clusters
- **autonomy_inventory_2027.png**: Time series of autonomy inventory requirements through 2027

## Methodology Summary

### Product Clusters

- **Cluster 1**: Floor Care (F), Kitchen Help (K), Leisure (L)
- **Cluster 2**: Safety & Security (S), Wall & Window Care (W), Exterior Care (X)

### Daily Production Rate Calculation

```
Daily_Production_Rate = Annual_Demand_P99 / Workdays_Per_Year
```

Where:
- `Annual_Demand_P99` = 99th percentile of annual demand across 100 simulations
- `Workdays_Per_Year` = 354 days (365 - 11 US holidays)

This ensures production can meet demand in 99 out of 100 scenarios.

### Prior Start Days Calculation

```
Prior_Start_Days = Required_Inventory_Jan1 / Net_Daily_Accumulation
```

Where:
- `Required_Inventory_Jan1` = Inventory needed on Jan 1 for 12-week 99% autonomy
- `Net_Daily_Accumulation` = Daily_Production - Daily_Demand_December

This accounts for:
1. Building up 84-day autonomy inventory
2. Meeting demand during the build-up period

### 12-Week 99% Autonomy Definition

"Inventory can satisfy all upcoming demand for 84 days with 99% probability"

Calculated by:
1. For each simulation, compute rolling 84-day forward cumulative demand
2. Take 99th percentile across all simulations
3. This is the required inventory level

## Key Assumptions

1. **Steady production**: Constant daily production rate throughout the year
2. **Workdays**: Factory operates 7 days/week except 11 US holidays (354 days/year)
3. **No stockouts**: Production starts early enough to prevent stockouts
4. **Product mix**: Mix variability within clusters is acceptable
5. **Build-up period**: During December of previous year, production serves both current year demand and builds inventory for next year

## Validation

The solution should be validated by:

1. **Simulation check**: Verify inventory stays positive with 99% probability
2. **Capacity check**: Ensure daily rates are feasible with factory capacity
3. **Lead time check**: Verify prior start days are reasonable (typically 60-120 days)

## Troubleshooting

### Issue: "ModuleNotFoundError: No module named 'pandas'"

**Solution:** Install required packages:
```bash
pip install pandas numpy matplotlib seaborn
```

### Issue: "FileNotFoundError: sim_batches not found"

**Solution:** Ensure you're running from the Task3 directory:
```bash
cd Task3
jupyter notebook
```

### Issue: Notebook takes too long to run

**Solution:** The full analysis processes 100 simulations × 2922 days × 24 models ≈ 7M data points. This may take 5-15 minutes depending on your machine. Consider:
- Reducing simulations for testing (modify notebook to load fewer batch files)
- Using a more powerful machine
- Running overnight for full analysis

## References

- **Main PDF**: ISYE 6339 - BotWorld Export-to-Europe Supply Chain Casework 1-1 2026.pdf
  - Task 3 description: Pages 6-8
  - Autonomy definition: Page 8
  - Product clusters: Page 6

## Questions?

Refer to `TASK3_SOLUTION_SUMMARY.md` for detailed methodology explanation.

---

**Generated**: 2026-02-25
**Author**: Task 3 Production Planning Team
